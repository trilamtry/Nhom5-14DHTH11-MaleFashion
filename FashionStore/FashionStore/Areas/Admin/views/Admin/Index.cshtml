@model FashionStore.Areas.Admin.Models.AdminDashboardViewModel

@{
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
    ViewBag.Title = "Dashboard - Tổng Quan";
    var cultureInfo = new System.Globalization.CultureInfo("vi-VN");
}

<div class="page-header">
    <h1 class="page-title">Dashboard - Tổng Quan</h1>
    <p class="page-subtitle">Xem tổng quan và theo dõi hoạt động kinh doanh</p>
</div>

<!-- Stats Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">@Model.TotalOrders.ToString("N0")</div>
                <div class="stat-label">Tổng đơn hàng</div>
            </div>
            <div class="stat-icon primary">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                    <path d="M17,18A2,2 0 0,1 19,20A2,2 0 0,1 17,22C15.89,22 15,21.1 15,20C15,18.89 15.89,18 17,18M1,2H4.27L5.21,4H20A1,1 0 0,1 21,5C21,5.17 20.95,5.34 20.88,5.5L17.3,11.97C16.96,12.58 16.3,13 15.55,13H8.1L7.2,14.63L7.17,14.75A0.25,0.25 0 0,0 7.42,15H19V17H7C5.89,17 5,16.1 5,15C5,14.65 5.09,14.32 5.24,14.04L6.6,11.59L3,4H1V2M7,18A2,2 0 0,1 9,20A2,2 0 0,1 7,22C5.89,22 5,21.1 5,20C5,18.89 5.89,18 7,18M16,11L18.78,6H6.14L8.5,11H16Z" />
                </svg>
            </div>
        </div>
        <div class="stat-footer">Đã xử lý</div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">@Model.TotalRevenueLast30Days.ToString("N0", cultureInfo) đ</div>
                <div class="stat-label">Doanh thu 30 ngày</div>
            </div>
            <div class="stat-icon success">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                    <path d="M7,15H9C9,16.08 10.37,17 12,17C13.63,17 15,16.08 15,15C15,13.9 13.96,13.5 11.76,12.97C9.64,12.44 7,11.78 7,9C7,7.21 8.47,5.69 10.5,5.18V3H13.5V5.18C15.53,5.69 17,7.21 17,9H15C15,7.92 13.63,7 12,7C10.37,7 9,7.92 9,9C9,10.1 10.04,10.5 12.24,11.03C14.36,11.56 17,12.22 17,15C17,16.79 15.53,18.31 13.5,18.82V21H10.5V18.82C8.47,18.31 7,16.79 7,15Z" />
                </svg>
            </div>
        </div>
        <div class="stat-footer success">Thành công</div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">@Model.TotalProducts.ToString("N0")</div>
                <div class="stat-label">Tổng sản phẩm</div>
            </div>
            <div class="stat-icon info">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                    <path d="M20,8H4V6H20M20,18H4V12H20M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z" />
                </svg>
            </div>
        </divapp
        <div class="stat-footer info">Đang kinh doanh</div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">@Model.TotalCustomers.ToString("N0")</div>
                <div class="stat-label">Khách hàng</div>
            </div>
            <div class="stat-icon warning">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                    <path d="M16,13C15.71,13 15.38,13 15.03,13.05C16.19,13.89 17,15 17,16.5V19H23V16.5C23,14.17 18.33,13 16,13M8,13C5.67,13 1,14.17 1,16.5V19H15V16.5C15,14.17 10.33,13 8,13M8,11A3,3 0 0,0 11,8A3,3 0 0,0 8,5A3,3 0 0,0 5,8A3,3 0 0,0 8,11M16,11A3,3 0 0,0 19,8A3,3 0 0,0 16,5A3,3 0 0,0 13,8A3,3 0 0,0 16,11Z" />
                </svg>
            </div>
        </div>
        <div class="stat-footer warning">Thành viên</div>
    </div>
</div>

<!-- Content Grid -->
<div class="content-grid">
    <!-- Recent Orders -->
    <div class="content-card orders-card">
        <div class="card-header">
            <div class="card-title">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path d="M9,10H7V12H9V10M13,10H11V12H13V10M17,10H15V12H17V10M19,3H18V1H16V3H8V1H6V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V8H19V19Z" />
                </svg>
                Đơn hàng mới nhất
            </div>
            <a href="@Url.Action("Index", "Order", new { area = "Admin" })" class="btn-link">
                Xem tất cả
                <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                    <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" />
                </svg>
            </a>
        </div>
        <div class="card-body">
            <div class="table-wrapper">
                <table class="modern-table">
                    <thead>
                        <tr>
                            <th>Mã đơn</th>
                            <th>Khách hàng</th>
                            <th>Tổng tiền</th>
                            <th>Trạng thái</th>
                            <th>Ngày đặt</th>
                            <th>Thao tác</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.RecentOrders != null && Model.RecentOrders.Any())
                        {
                            foreach (var item in Model.RecentOrders)
                            {
                                string badgeClass = "";
                                string statusText = "";

                                switch (item.Status)
                                {
                                    case "COMPLETED":
                                        badgeClass = "success";
                                        statusText = "Hoàn thành";
                                        break;
                                    case "PENDING":
                                        badgeClass = "warning";
                                        statusText = "Chờ xử lý";
                                        break;
                                    case "SHIPPING":
                                        badgeClass = "info";
                                        statusText = "Đang giao";
                                        break;
                                    case "CANCELLED":
                                        badgeClass = "danger";
                                        statusText = "Đã hủy";
                                        break;
                                    default:
                                        badgeClass = "secondary";
                                        statusText = item.Status;
                                        break;
                                }

                                <tr>
                                    <td><strong class="order-code">@item.OrderCode</strong></td>
                                    <td>@item.CustomerName</td>
                                    <td><strong>@item.TotalAmount.ToString("N0", cultureInfo) đ</strong></td>
                                    <td><span class="badge @badgeClass">@statusText</span></td>
                                    <td>@item.CreatedAt.ToString("dd/MM/yyyy")</td>
                                    <td>
                                        <a href="@Url.Action("Details", "Order", new { id = item.OrderId, area = "Admin" })" class="btn-action" title="Xem chi tiết">
                                            <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" />
                                            </svg>
                                        </a>
                                    </td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="6" class="text-center empty-state">
                                    <svg viewBox="0 0 24 24" width="48" height="48" fill="currentColor">
                                        <path d="M17,18A2,2 0 0,1 19,20A2,2 0 0,1 17,22C15.89,22 15,21.1 15,20C15,18.89 15.89,18 17,18M1,2H4.27L5.21,4H20A1,1 0 0,1 21,5C21,5.17 20.95,5.34 20.88,5.5L17.3,11.97C16.96,12.58 16.3,13 15.55,13H8.1L7.2,14.63L7.17,14.75A0.25,0.25 0 0,0 7.42,15H19V17H7C5.89,17 5,16.1 5,15C5,14.65 5.09,14.32 5.24,14.04L6.6,11.59L3,4H1V2M7,18A2,2 0 0,1 9,20A2,2 0 0,1 7,22C5.89,22 5,21.1 5,20C5,18.89 5.89,18 7,18M16,11L18.78,6H6.14L8.5,11H16Z" />
                                    </svg>
                                    <p>Không có đơn hàng nào gần đây</p>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Low Stock Alert -->
    <div class="content-card alert-card">
        <div class="card-header">
            <div class="card-title">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path d="M13 14H11V9H13M13 18H11V16H13M1 21H23L12 2L1 21Z" />
                </svg>
                Cảnh báo hàng sắp hết
            </div>
        </div>
        <div class="card-body">
            @if (Model.LowStockVariants != null && Model.LowStockVariants.Any())
            {
                <div class="alert-list">
                    @foreach (var variant in Model.LowStockVariants)
                    {
                        <div class="alert-item">
                            <div class="alert-info">
                                <div class="product-name">@variant.Product.ProductName</div>
                                <div class="variant-info">
                                    Size: <strong>@variant.Size.SizeCode</strong> - Màu: <strong>@variant.Color.ColorName</strong>
                                </div>
                            </div>
                            <div class="stock-badge danger">
                                @variant.Stock
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="success-message">
                    <svg viewBox="0 0 24 24" width="48" height="48" fill="currentColor">
                        <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />
                    </svg>
                    <p>Tuyệt vời! Tất cả sản phẩm đều đủ tồn kho (> 10).</p>
                </div>
            }
            <a href="@Url.Action("Index", "Product", new { area = "Admin" })" class="btn-primary full-width">
                Quản lý Sản phẩm
            </a>
        </div>
    </div>
</div>